<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproducir audio de YouTube en móviles</title>
    <style>
        /* Ajustar la barra de progreso y otros elementos para pantallas pequeñas */
        #progressBar {
            width: 80%;
            height: 10px;
            background-color: #e0e0e0;
            margin: 20px auto;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
        }
        #progress {
            height: 100%;
            background-color: #76a9ea;
            width: 0;
            border-radius: 5px;
        }
        #time {
            text-align: center;
            font-size: 1rem;
        }
        button {
            font-size: 1.2rem;
            padding: 10px 20px;
            margin: 10px;
        }

        /* Estilo para pantallas más pequeñas */
        @media (max-width: 600px) {
            #progressBar {
                width: 90%;
            }
            button {
                font-size: 1rem;
                padding: 8px 16px;
            }
        }
    </style>
</head>
<body>
    <h1>Reproducir audio de YouTube en móviles</h1>

    <!-- Botón para reproducir el audio -->
    <button onclick="playAudio()">Reproducir</button>
    <button onclick="pauseAudio()">Pausar</button>

    <!-- Barra de progreso personalizada -->
    <div id="progressBar" onclick="seek(event)">
        <div id="progress"></div>
    </div>

    <!-- Tiempo de reproducción -->
    <div id="time">
        <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
    </div>

    <!-- Reproductor de YouTube oculto -->
    <div id="player" style="display: none;"></div>

    <script>
        // 1. Cargar la API del reproductor de YouTube
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;
        var duration = 0;

        // 2. Inicializar el reproductor cuando la API esté lista
        function onYouTubeIframeAPIReady() {
            // Pedir el ID del video o enlace al cargar la página
            var videoId = prompt("Ingresa el ID del video o el enlace completo de YouTube:");

            // Extraer el ID del video desde el enlace o usar el ID proporcionado
            videoId = extractVideoId(videoId);

            player = new YT.Player('player', {
                videoId: videoId,  // Usar el ID proporcionado
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 3. Iniciar el reproductor cuando esté listo
        function onPlayerReady(event) {
            duration = player.getDuration();  // Obtener la duración del video
            document.getElementById('duration').innerText = formatTime(duration);
        }

        // 4. Función para extraer el ID del video desde el enlace o ID
        function extractVideoId(input) {
            var videoId = input;
            // Si es un enlace completo, extraer el ID
            var regex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
            var match = input.match(regex);
            if (match) {
                videoId = match[1];
            }
            return videoId;
        }

        // 5. Reproducir el audio
        function playAudio() {
            player.playVideo();
        }

        // 6. Pausar el audio
        function pauseAudio() {
            player.pauseVideo();
        }

        // 7. Controlar el estado del reproductor
        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                // Actualizar la barra de progreso cada segundo
                setInterval(updateProgressBar, 1000);
            }
        }

        // 8. Función para actualizar la barra de progreso
        function updateProgressBar() {
            var currentTime = player.getCurrentTime();  // Tiempo actual del video
            var progress = (currentTime / duration) * 100;  // Porcentaje completado
            document.getElementById('progress').style.width = progress + '%';
            document.getElementById('currentTime').innerText = formatTime(currentTime);
        }

        // 9. Función para buscar una nueva posición en el video cuando se hace clic en la barra
        function seek(event) {
            var progressBar = document.getElementById('progressBar');
            var clickPosition = event.offsetX / progressBar.offsetWidth;  // Porcentaje clicado
            var newTime = clickPosition * duration;  // Nuevo tiempo en segundos
            player.seekTo(newTime, true);  // Saltar a la nueva posición
        }

        // 10. Formatear el tiempo en minutos y segundos
        function formatTime(time) {
            var minutes = Math.floor(time / 60);
            var seconds = Math.floor(time % 60);
            if (seconds < 10) {
                seconds = '0' + seconds;
            }
            return minutes + ':' + seconds;
        }
    </script>
</body>
</html>
